This is the code for our works, entitled "Cranial implant prediction by learning an ensemble of slice-based skull completion networks", published in the MICCAI AutoImplant Challenge 2021.

Abstract:
The development of automatic skull reconstruction methods has dramatically reduced the time and expense to repair skull defects. In this study, an ensemble-learning-based method is proposed for skull implant prediction. To overcome the potential overfit problem in 3-D volume analysis using deep learning, a set of 2-D defective skull images is generated by slicing 3-D volumes along the X, Y, and Z axes. We further introduce an RNN model in this method to compensate for the loss of global skull information in the 2-D implant prediction. Over the implant estimation problem in Task 1 of the AutoImplant 2021 challenge, we observe a considerable performance boost from our averaging ensemble strategy and noise removal filtering.

Readme:
To run this model, one needs to put the folder containing nrrd files under the "SourceCode' direction. Note, all 3-D nrrd files should be in the size of 512x512x512. Since our method deploys 2-D models to process 3-D volume data, one needs to synthesize corresponding 2-D training sets from the 3-D volumes. We provide a python file entitled "CreateCNNdataset.py" for this purpose. Then please run the code directly if you want to train the models on the Challenge Task 1 dataset. Otherwise, if you're going to train the models on your dataset, please modify folderPath variables, output variables, skulls variables, imp_data variables, and the def_data variables correspondingly. The first part codes in the python file are used to reorder the nrrd files provided by the competition team. You may not need to do so for your own dataset. The second part is to create 2-D slices along the X, Y,and Z axes. In addition, we found that blank slices that don't contain cranial bones or skull defects harm the training. So we removed all blank slices from the 2-D training sets in this study. 

With your 2-D slice training sets, model training and evaluation are specified in the CodeForPaper.ipynb file. Please follow the instructions in the file to get the result.

Citation:
If you find the code useful in your research, please consider citing:
@inproceedings{SKullImplant2021,
title={Cranial implant prediction by learning an ensemble of slice-based skull completion networks},
author = {Bokai Yang, Ke Fang, and Xingyu Li},
Journal = {MICCAI Second MICCAI challenge on cranial implant design}
year = {2021}
}